---
title: "Assembling a data set for a PK/PD"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{pkpd}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## Load puzzle
```{r setup}
library(puzzle)
```

## Puzzle input
```{r, warning=F, message=T, error=F, results='asis', echo=T}
nm = list(pk = list(parent=as.data.frame(puzzle::df_pk_start)),
          pd = list(response=as.data.frame(puzzle::df_pd_start)),
          dose=as.data.frame(puzzle::df_dose_start),
          cov=as.data.frame(puzzle::df_cov_time_dependent_start))
```

## Puzzle code
```{r, warning=F, message=T, error=F, results='hide', echo=T}
puzzle(directory=file.path(getwd()),
       order=c(1),
       pk=list(data=nm$pk), 
       pd=list(data=nm$pd), 
       dose=list(data=nm$dose), 
       cov=list(data=nm$cov))
```

## Puzzle output
```{r, warning=F, message=F, error=F, results='asis', echo=FALSE}
library(tidyverse)
df = puzzle(directory=file.path(getwd()),
             order=c(1),
             pk=list(data=nm$pk),
             pd=list(data=nm$pd), 
             dose=list(data=nm$dose), 
             cov=list(data=nm$cov)) %>% 
  dplyr::mutate_if(is.numeric, round, digits=1)
df %>%
  knitr::kable() %>%
  kableExtra::kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```
